Generate a self signed x509 certificate from node.js.

[![Build Status](https://travis-ci.org/jfromaniello/selfsigned.png)](https://travis-ci.org/jfromaniello/selfsigned)

## Install

```bash
  npm install selfsigned
```

## Usage

```js
var selfsigned = require('selfsigned');
var attrs = [{ name: 'commonName', value: 'contoso.com' }];
var pems = selfsigned.generate(attrs, { days: 365 });
console.log(pems)
```

#### Async

```js
selfsigned.generate(attrs, { days: 365 }, function (err, pems) {
  console.log(pems)
});
```

Will return the following like this:

```js
{
  private: '-----BEGIN RSA PRIVATE KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\n-----END RSA PRIVATE KEY-----\r\n',
  public: '-----BEGIN PUBLIC KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\ngY0m5WIuaKrW6mvLXQIDAQAB\r\n-----END PUBLIC KEY-----\r\n',
  cert: '-----BEGIN CERTIFICATE-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\n-----END CERTIFICATE-----\r\n'
}
```

## Attributes

for attributes, please refer to: https://github.com/digitalbazaar/forge/blob/0.7.5/lib/x509.js#L129

## Options

```js
var pems = selfsigned.generate(null, {
  keySize: 2048, // the size for the private key in bits (default: 1024)
  days: 30, // how long till expiry of the signed certificate (default: 365)
  algorithm: 'sha256', // sign the certificate with specified algorithm (default: 'sha1')
  extensions: [{ name: 'basicConstraints', cA: true }], // certificate extensions array
  pkcs7: true, // include PKCS#7 as part of the output (default: false)
  clientCertificate: true, // generate client cert signed by the original key (default: false)
  clientCertificateCN: 'jdoe' // client certificate's common name (default: 'John Doe jdoe123')
});
```

> You can avoid key pair generation specifying your own keys (`{ keyPair: { publicKey: '-----BEGIN PUBLIC KEY-----...', privateKey: '-----BEGIN RSA PRIVATE KEY-----...' }`)

### Generate Client Certificates

If you are in an environment where servers require client certificates, you can generate client keys signed by the original (server) key.

```js
var pems = selfsigned.generate(null, { clientCertificate: true });
console.log(pems)
```
Will return the following like this:

```js
{ private: '-----BEGIN RSA PRIVATE KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\n-----END RSA PRIVATE KEY-----\r\n',
  public: '-----BEGIN PUBLIC KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\no0XRRXVVboZsfNpuGQIDAQAB\r\n-----END PUBLIC KEY-----\r\n',
  cert: '-----BEGIN CERTIFICATE-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\n-----END CERTIFICATE-----\r\n',
  clientprivate: '-----BEGIN RSA PRIVATE KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\n-----END RSA PRIVATE KEY-----\r\n',
  clientpublic: '-----BEGIN PUBLIC KEY-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\ndPc4ZOUgA5ASZ0h2ewIDAQAB\r\n-----END PUBLIC KEY-----\r\n',
  clientcert: '-----BEGIN CERTIFICATE-----\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\DELETED_BASE64_STRING\r\nnizRS0HY4Q25JLCmsWWy\r\n-----END CERTIFICATE-----\r\n' }
```

To override the default client CN of `john doe jdoe123`, add another option for `clientCertificateCN`:

```js
var pems = selfsigned.generate(null, { clientCertificate: true, clientCertificateCN: 'FooBar' });
```

## License

MIT
