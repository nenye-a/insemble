# Migration `20200224174425-add-tenant-email-verification`

This migration has been generated by Joshua at 2/24/2020, 5:44:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."TenantRegisterVerification" (
    "businessInput" text  NOT NULL DEFAULT '',
    "email" text  NOT NULL DEFAULT '',
    "filterInput" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "tenantInput" text  NOT NULL DEFAULT '',
    "verified" boolean  NOT NULL DEFAULT false,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."TenantEmailVerification" (
    "email" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "user" text  NOT NULL ,
    "verified" boolean  NOT NULL DEFAULT false,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."TenantUser" ADD COLUMN "pendingEmail" boolean  NOT NULL DEFAULT false;

ALTER TABLE "public"."TenantEmailVerification" ADD FOREIGN KEY ("user") REFERENCES "public"."TenantUser"("id") ON DELETE RESTRICT

DROP TABLE "public"."TenantVerification";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200224142701-remove-max-size-and-max-front-width..20200224174425-add-tenant-email-verification
--- datamodel.dml
+++ datamodel.dml
@@ -1,35 +1,31 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://prisma:prisma@localhost:5432/insemble?schema=public"
 }
 generator client {
   provider = "prisma-client-js"
 }
 enum TenantTier {
-  FREE
-  EXPLORE
-  SMART
-  PROFESSIONAL
+  FREE EXPLORE SMART PROFESSIONAL
 }
 enum LandlordTier {
-  FREE
-  EXPLORE
-  SMART
-  PROFESSIONAL
+  FREE EXPLORE SMART PROFESSIONAL
 }
 enum NewLocationPlan {
-  YES
-  NOT_ACTIVE
-  NOT_PLANNING
+  YES NOT_ACTIVE NOT_PLANNING
 }
+enum MarketingPreference {
+  PUBLIC PRIVATE
+}
+
 // model MatchingLocation {
 //   id    String @id
 //   lat   Float
 //   lng   Float
@@ -60,20 +56,21 @@
   estimate     String
 }
 model TenantUser {
-  id          String     @id @default(cuid())
-  email       String     @unique
-  avatar      String?
-  password    String
-  firstName   String
-  lastName    String
-  company     String
-  phoneNumber String?
-  title       String?
-  description String?
-  brands      Brand[]
-  tier        TenantTier
+  id           String     @id @default(cuid())
+  email        String     @unique
+  avatar       String?
+  password     String
+  firstName    String
+  lastName     String
+  company      String
+  phoneNumber  String?
+  title        String?
+  description  String?
+  brands       Brand[]
+  tier         TenantTier
+  pendingEmail Boolean    @default(false)
 }
 model LandlordUser {
   id          String       @id @default(cuid())
@@ -124,14 +121,11 @@
   matchingProperties     MatchingProperty[]
   createdAt              DateTime                 @default(now())
 }
-enum MarketingPreference {
-  PUBLIC
-  PRIVATE
-}
+
 model Space {
   id String @id @default(cuid())
   mainPhoto    String
@@ -171,4 +165,20 @@
   token     String
   createdAt DateTime     @default(now())
   user      LandlordUser
 }
+
+model TenantRegisterVerification {
+  id            String  @default(cuid()) @id
+  businessInput String
+  tenantInput   String
+  filterInput   String
+  email         String
+  verified      Boolean @default(false)
+}
+
+model TenantEmailVerification {
+  id       String     @default(cuid()) @id
+  email    String
+  user     TenantUser
+  verified Boolean    @default(false)
+}
```


